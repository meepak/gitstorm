<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitStorm Panel</title>
    <!-- CSS_PLACEHOLDER -->
    <!-- SVG_ASSETS_PLACEHOLDER -->
</head>
<body oncontextmenu="return false;">
    <div class="header">
        <h1><img class="header-icon" data-icon="gitstorm" alt="GitStorm" />GitStorm</h1>
        <div class="header-toolbar">
            <button id="refreshButton" class="toolbar-button" title="Refresh Data">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="23 4 23 10 17 10"></polyline>
                    <polyline points="1 20 1 14 7 14"></polyline>
                    <path d="m3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                </svg>
            </button>
        </div>
    </div>
    
    <!-- Global loading spinner -->
    <div id="globalLoadingSpinner" class="global-loading-spinner" style="display: none;">
        <div class="spinner"></div>
        <div class="loading-text">Loading...</div>
    </div>
    
    <div class="main-content">
        <div id="branchesPanel" class="panel branches-panel">
            <div class="panel-header" oncontextmenu="event.preventDefault(); showPanelContextMenu(event, 'branches')">
                <span class="panel-title"><img class="panel-icon" data-icon="git-branches" alt="Branches" /> BRANCHES</span>
                <div class="search-container">
                    <div class="search-input-wrapper">
                        <svg class="search-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="branchesSearch" placeholder="Search branches..." />
                    </div>
                    <button class="clear-search" onclick="clearBranchesSearch()" title="Clear search">√ó</button>
                </div>
            </div>
            <div class="panel-content">
                <div id="branchesContent">
                    <div class="empty-state"><h3>No branches</h3><p>Select a repository to view branches</p></div>
                </div>
            </div>
            <div id="resizeBranches" class="resize-handle" data-panel="branches"></div>
        </div>
        
        <div id="commitsPanel" class="panel commits-panel">
            <div class="panel-header" oncontextmenu="event.preventDefault(); showPanelContextMenu(event, 'commits')">
                <span class="panel-title"><img class="panel-icon" data-icon="git-commit" alt="Commits" /> COMMITS</span>
                <div class="search-container">
                    <div class="search-input-wrapper">
                        <svg class="search-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="commitsSearch" placeholder="Search commits..." />
                    </div>
                    <button class="clear-search" onclick="clearCommitsSearch()" title="Clear search">√ó</button>
                </div>
            </div>
            <div class="panel-sub-header">
                <div class="panel-filters">
                    <select id="userFilter" class="user-filter">
                        <option value="all">All Authors</option>
                    </select>
                    <div class="compare">
                        <img class="panel-icon" data-icon="compare" alt="Compare"  title="Compare Against"/>
                        <select id="commitsCompareFilter" class="compare-select">
                            <option value="none">Show all commits</option>
                            <option value="" disabled style="font-style: italic; color: #666;">Select branch to compare</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="panel-content">
                <div id="commitsContent">
                    <div class="empty-state"><h3>No commits</h3><p>Select a branch to view commits</p></div>
                </div>
            </div>
            <div id="resizeCommits" class="resize-handle" data-panel="commits"></div>
        </div>
        
        <div id="filesPanel" class="panel files-panel">
            <div class="panel-header" oncontextmenu="event.preventDefault(); showPanelContextMenu(event, 'files')">
                <span class="panel-title"><img class="panel-icon" data-icon="git-changes" alt="Changes" /> CHANGES</span>
                <div class="search-container">
                    <div class="search-input-wrapper">
                        <svg class="search-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="filesSearch" placeholder="Search files..." />
                    </div>
                    <button class="clear-search" onclick="clearFilesSearch()" title="Clear search">√ó</button>
                </div>
            </div>
            <div class="panel-sub-header">
                <div class="panel-filters">
                    <div class="compare">
                        <img class="panel-icon" data-icon="compare" alt="Compare" title="Compare Against" />
                        <select id="filesCompareFilter" class="compare-select">
                            <option value="working">Current Working Directory</option>
                            <option value="previous">Previous Commit</option>
                            <option value="" disabled style="font-style: italic; color: #666;">Select Branch to Compare</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="panel-content">
                <div id="filesContent">
                    <div class="empty-state"><h3>No files</h3><p>Select a commit to view file changes</p></div>
                </div>
            </div>
            <div class="panel-footer" id="filesFooter">
                <!-- Commit details will be populated here -->
            </div>
            <div id="resizeFiles" class="resize-handle" data-panel="files"></div>
        </div>
        
        <div class="panel diff-panel">
            <div class="panel-header" oncontextmenu="event.preventDefault(); showPanelContextMenu(event, 'diff')">
                <span class="panel-title"><img class="panel-icon" data-icon="git-diff" alt="Diff" /> DIFF VIEWER</span>
            </div>
            <div class="panel-content">
                <div id="diffContent">
                    <div class="empty-state">
                        <h3>No diff selected</h3>
                        <p>Click on a file to view its changes</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Custom Context Menu -->
    <div id="contextMenu" class="context-menu" style="display: none;">
        <!-- Text/Branch/Commit common actions -->
        <div class="context-menu-item" data-action="copy">
            <span class="context-menu-icon">üìã</span>
            <span class="context-menu-text">Copy</span>
        </div>
        
        <!-- File-specific actions -->
        <div class="context-menu-item" data-action="open">
            <span class="context-menu-icon">üìÑ</span>
            <span class="context-menu-text">Open File</span>
        </div>
        <div class="context-menu-item" data-action="diff">
            <span class="context-menu-icon">üîç</span>
            <span class="context-menu-text">Show Diff</span>
        </div>
        <div class="context-menu-item" data-action="copy-path">
            <span class="context-menu-icon">üìÅ</span>
            <span class="context-menu-text">Copy Path</span>
        </div>
        <div class="context-menu-item" data-action="reveal">
            <span class="context-menu-icon">üóÇÔ∏è</span>
            <span class="context-menu-text">Reveal in Explorer</span>
        </div>
        
        <!-- Branch-specific actions -->
        <div class="context-menu-item" data-action="checkout">
            <span class="context-menu-icon">üåø</span>
            <span class="context-menu-text">Checkout Branch</span>
        </div>
        <div class="context-menu-item" data-action="merge">
            <span class="context-menu-icon">üîÄ</span>
            <span class="context-menu-text">Merge Branch</span>
        </div>
        <div class="context-menu-item" data-action="delete-branch">
            <span class="context-menu-icon">üóëÔ∏è</span>
            <span class="context-menu-text">Delete Branch</span>
        </div>
        
        <!-- Commit-specific actions -->
        <div class="context-menu-item" data-action="create-branch">
            <span class="context-menu-icon">üåø</span>
            <span class="context-menu-text">Create Branch</span>
        </div>
        <div class="context-menu-item" data-action="cherry-pick">
            <span class="context-menu-icon">üçí</span>
            <span class="context-menu-text">Cherry Pick</span>
        </div>
        <div class="context-menu-item" data-action="revert">
            <span class="context-menu-icon">‚Ü©Ô∏è</span>
            <span class="context-menu-text">Revert</span>
        </div>
        <div class="context-menu-item" data-action="squash">
            <span class="context-menu-icon">üóúÔ∏è</span>
            <span class="context-menu-text">Squash Commits</span>
        </div>
        <div class="context-menu-item" data-action="commit">
            <span class="context-menu-icon">üíæ</span>
            <span class="context-menu-text">Commit Changes</span>
        </div>
        <div class="context-menu-item" data-action="stage-all">
            <span class="context-menu-icon">‚ûï</span>
            <span class="context-menu-text">Stage All Changes</span>
        </div>
        <div class="context-menu-item" data-action="stash">
            <span class="context-menu-icon">üì¶</span>
            <span class="context-menu-text">Stash Changes</span>
        </div>
        <div class="context-menu-item" data-action="commit-staged">
            <span class="context-menu-icon">üíæ</span>
            <span class="context-menu-text">Commit Staged Changes</span>
        </div>
        <div class="context-menu-item" data-action="unstage-all">
            <span class="context-menu-icon">‚ûñ</span>
            <span class="context-menu-text">Unstage All Changes</span>
        </div>
        <div class="context-menu-item" data-action="push">
            <span class="context-menu-icon">üöÄ</span>
            <span class="context-menu-text">Push Commit</span>
        </div>
        
        <div class="context-menu-separator"></div>
        <div class="context-menu-item" data-action="refresh">
            <span class="context-menu-icon">üîÑ</span>
            <span class="context-menu-text">Refresh</span>
        </div>
    </div>
    
    <!-- Load JavaScript modules in correct order -->
    <script src="managers/CacheManager.js"></script>
    <script src="core/PanelController.js"></script>
    <script src="handlers/MessageHandler.js"></script>
    <script src="handlers/ContextMenuHandler.js"></script>
    <script src="renderers/BranchRenderer.js"></script>
    <script src="renderers/CommitRenderer.js"></script>
    <script src="renderers/FileChangesRenderer.js"></script>
    <script src="renderers/FilterRenderer.js"></script>
    <script src="renderers/IconRenderer.js"></script>
    <script src="renderers/UIRenderer.js"></script>
    <script src="managers/SearchManager.js"></script>
    <script src="components/ConfirmationDialog.js"></script>
    <script src="operations/GitOperations.js"></script>
    <script src="globals.js"></script>
    
    <!-- INITIAL_PANEL_SIZES_PLACEHOLDER -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Load SVG icons for static content
            loadSvgIcons();
            // Setup automatic SVG icon loading for dynamic content
            setupSvgIconObserver();
        });
    </script>
</body>
</html>
