/* ===== CSS CUSTOM PROPERTIES ===== */
:root {
    --panel-border: var(--vscode-panel-border);
    --input-bg: var(--vscode-input-background);
    --input-fg: var(--vscode-input-foreground);
    --input-border: var(--vscode-input-border);
    --focus-border: var(--vscode-focusBorder);
    --button-bg: var(--vscode-button-background);
    --button-fg: var(--vscode-button-foreground);
    --button-hover: var(--vscode-button-hoverBackground);
    --list-hover: var(--vscode-list-hoverBackground);
    --list-hover-fg: var(--vscode-list-hoverForeground);
    --list-active: var(--vscode-list-activeSelectionBackground);
    --list-active-fg: var(--vscode-list-activeSelectionForeground);
    --list-inactive: var(--vscode-list-inactiveSelectionBackground);
    --dropdown-bg: var(--vscode-dropdown-background, var(--vscode-input-background));
    --dropdown-fg: var(--vscode-dropdown-foreground, var(--vscode-input-foreground));
    --description-fg: var(--vscode-descriptionForeground);
    --font-size: var(--vscode-font-size);
    --font-family: var(--vscode-font-family);
    --foreground: var(--vscode-foreground);
    --editor-bg: var(--vscode-editor-background);
    --title-bg: var(--vscode-titleBar-activeBackground);
    --title-fg: var(--vscode-titleBar-activeForeground);
    --panel-bg: var(--vscode-panel-background);
    --panel-fg: var(--vscode-panel-foreground);
    --menu-bg: var(--vscode-menu-background);
    --menu-fg: var(--vscode-menu-foreground);
    --menu-border: var(--vscode-menu-border);
    --menu-selection-bg: var(--vscode-menu-selectionBackground);
    --menu-selection-fg: var(--vscode-menu-selectionForeground);
    --menu-separator: var(--vscode-menu-separatorBackground);
    --widget-shadow: var(--vscode-widget-shadow);
    --text-link: var(--vscode-textLink-foreground);
    --charts-orange: var(--vscode-charts-orange);
    --charts-green: var(--vscode-charts-green);
    --charts-red: var(--vscode-charts-red);
    --charts-blue: var(--vscode-charts-blue);
    --diff-inserted-bg: var(--vscode-diffEditor-insertedTextBackground);
    --diff-inserted-fg: var(--vscode-diffEditor-insertedTextForeground);
    --diff-removed-bg: var(--vscode-diffEditor-removedTextBackground);
    --diff-removed-fg: var(--vscode-diffEditor-removedTextForeground);
    --tooltip-bg: var(--vscode-editor-background);
    --tooltip-fg: var(--vscode-editor-foreground);
    --tooltip-border: var(--vscode-panel-border);
    --tooltip-shadow: var(--vscode-widget-shadow);
    
    /* Common spacing */
    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 12px;
    --spacing-lg: 16px;
    --spacing-xl: 20px;
    
    /* Common border radius */
    --radius-sm: 3px;
    --radius-md: 6px;
    
    /* Common transitions */
    --transition-fast: 0.15s ease;
    --transition-normal: 0.2s ease;
}

/* ===== RESET & BASE ===== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

/* ===== TOOLTIPS ===== */
.has-tooltip {
    position: relative;
    cursor: pointer;
}

.has-tooltip:hover::after {
    content: attr(data-full-message);
    position: absolute;
    bottom: 100%;
    left: 0;
    background-color: var(--tooltip-bg);
    color: var(--tooltip-fg);
    border: 1px solid var(--tooltip-border);
    border-radius: var(--radius-sm);
    padding: var(--spacing-sm);
    font-size: 11px;
    white-space: normal;
    word-wrap: break-word;
    z-index: 1000;
    box-shadow: var(--tooltip-shadow);
    margin-bottom: 5px;
}

.commit-hash.has-tooltip:hover::after {
    content: attr(data-full-hash);
    white-space: nowrap;
}

.commit-author.has-tooltip:hover::after {
    content: attr(data-full-author);
    white-space: nowrap;
}

.commit-message.has-tooltip:hover::after {
    content: attr(data-full-message);
    max-width: 300px;
}

body {
    font-family: var(--font-family);
    font-size: var(--font-size);
    color: var(--foreground);
    background-color: var(--editor-bg);
    height: 100vh;
    display: flex;
    flex-direction: column;
}

/* ===== LAYOUT ===== */
.header {
    background-color: var(--title-bg);
    color: var(--title-fg);
    padding: var(--spacing-sm) var(--spacing-md);
    border-bottom: 1px solid var(--panel-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
}

.main-content {
    display: flex;
    flex: 1;
    min-height: 0;
}

.panel {
    border-right: 1px solid var(--panel-border);
    display: flex;
    flex-direction: column;
    min-width: 200px;
    position: relative;
    height: 100%;
}

.panel:last-child {
    border-right: none;
}

/* ===== PANEL TYPES ===== */
.branches-panel { width: 280px; }
.commits-panel { width: 350px; }
.files-panel { width: 300px; }
.diff-panel { 
    flex: 1; 
    min-width: 300px;
}

/* ===== PANEL HEADERS ===== */
.panel-header {
    background-color: var(--panel-bg);
    color: var(--panel-fg);
    padding: var(--spacing-sm) var(--spacing-md);
    border-bottom: 1px solid var(--panel-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
    user-select: none;
    position: sticky;
    top: 0;
    z-index: 10;
}

/* ===== HEADERS & FILTERS ===== */
.panel-sub-header {
    background-color: var(--panel-bg);
    padding: var(--spacing-sm) var(--spacing-md);
    border-bottom: 1px solid var(--panel-border);
    flex-shrink: 0;
    position: sticky;
    top: 50px; /* Below the main panel header */
    z-index: 10;
}

.panel-content {
    flex: 1;
    overflow-y: auto;
}

.panel-filters {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
}

/* ===== SEARCH & INPUTS ===== */
.search-container {
    flex: 1;
    position: relative;
    padding-left: 1em;
}

input[type="text"] {
    width: 100%;
    padding: var(--spacing-xs) var(--spacing-sm);
    border: 1px solid var(--input-border);
    background-color: var(--input-bg);
    color: var(--input-fg);
    border-radius: var(--radius-sm);
    font-size: 12px;
    outline: none;
    transition: border-color var(--transition-fast);
}

input[type="text"]:focus {
    border-color: var(--focus-border);
}

.clear-search {
    position: absolute;
    right: var(--spacing-xs);
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: var(--description-fg);
    cursor: pointer;
    font-size: 16px;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all var(--transition-fast);
}

.clear-search:hover {
    background-color: var(--list-hover);
    color: var(--list-hover-fg);
}

.clear-search:active {
    background-color: var(--list-active);
    color: var(--list-active-fg);
}

/* ===== DROPDOWNS ===== */
.user-filter,
.compare-select {
    padding: var(--spacing-xs) var(--spacing-sm);
    border: 1px solid var(--input-border);
    background-color: var(--input-bg);
    color: var(--input-fg);
    border-radius: var(--radius-sm);
    font-size: 12px;
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right var(--spacing-sm) center;
    background-size: 12px;
    padding-right: 28px;
    transition: all var(--transition-fast);
}

.user-filter:focus,
.compare-select:focus {
    outline: none;
    border-color: var(--focus-border);
}

.user-filter:hover,
.compare-select:hover {
    background-color: var(--input-bg);
    border-color: var(--focus-border);
}

.compare-select {
    min-width: 150px;
}

.compare {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    width: 100%;
}

.compare .compare-select {
    flex: 1;
    min-width: 0;
    width: 100%;
}

/* Dropdown options */
.user-filter option,
.compare-select option {
    background-color: var(--dropdown-bg);
    color: var(--dropdown-fg);
    padding: var(--spacing-xs) var(--spacing-sm);
}

.user-filter option:hover,
.compare-select option:hover {
    background-color: var(--list-hover);
    color: var(--list-hover-fg);
}

.user-filter option:checked,
.compare-select option:checked {
    background-color: var(--list-active);
    color: var(--list-active-fg);
}

/* ===== BUTTONS ===== */
button {
    background-color: var(--button-bg);
    color: var(--button-fg);
    border: none;
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--radius-sm);
    cursor: pointer;
    font-size: 12px;
    transition: background-color var(--transition-fast);
}

button:hover {
    background-color: var(--button-hover);
}

/* ===== ITEMS & LISTS ===== */
.branch-item,
.commit-item {
    padding: var(--spacing-xs) var(--spacing-sm);
    margin: 2px 0;
    border-radius: var(--radius-sm);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    transition: background-color var(--transition-fast);
    user-select: none;
    min-width: 0;
}

.branch-item:hover,
.commit-item:hover {
    background-color: var(--list-hover);
}

.branch-item.selected,
.commit-item.selected {
    background-color: var(--list-active);
    color: var(--list-active-fg);
}

.commit-item.uncommitted-changes {
    background-color: var(--charts-orange);
    color: var(--editor-bg);
    font-weight: bold;
}

.commit-item.uncommitted-changes:hover {
    background-color: var(--charts-orange);
    opacity: 0.8;
}

.commit-item.uncommitted-changes.selected {
    background-color: var(--charts-orange);
    color: var(--editor-bg);
    opacity: 1;
}

/* ===== ICONS & TEXT ===== */
.branch-icon,
.commit-icon {
    font-size: 14px;
    flex-shrink: 0;
}

.branch-name,
.commit-message {
    flex: 1;
    font-size: 12px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    min-width: 0;
    max-width: 100%;
}

.commit-item {
    padding-top: var(--spacing-md);
    padding-bottom: var(--spacing-md);
    border-bottom: 1px solid var(--list-inactive, rgba(255, 255, 255, 0.03));
}

.branch-refs,
.commit-refs {
    font-size: 10px;
    color: var(--description-fg);
    flex-shrink: 0;
}

.branch-item.current .branch-name {
    font-style: italic;
    text-decoration: underline;
    color: var(--text-link);
}

.branch-item.selected .branch-name {
    font-weight: bold;
}

/* ===== COMMIT GRAPH ===== */
.commits-container {
    position: relative;
    padding-left: 20px;
}

.commits-container::before {
    content: '';
    position: absolute;
    left: 10px;
    top: 0;
    bottom: 0;
    width: 2px;
    background-color: var(--panel-border);
}

.commit-graph {
    position: absolute;
    left: 0;
    top: 0;
    width: 20px;
    height: 100%;
    pointer-events: none;
}

.dag-branch-line,
.dag-branch-line-merge,
.dag-merge-line,
.dag-merge-line-merge {
    position: absolute;
    background-color: var(--panel-border);
}

.dag-commit,
.dag-uncommitted,
.dag-merge,
.dag-first,
.dag-merge-commit {
    position: absolute;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: var(--panel-border);
    border: 2px solid var(--editor-bg);
}

.commit-content {
    padding-left: var(--spacing-md);
    position: relative;
    z-index: 1;
    flex: 1;
    min-width: 0;
}

.commit-content > div:first-child {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    min-width: 0;
}

.commit-hash {
    font-family: 'Courier New', monospace;
    font-size: 11px;
    color: var(--text-link);
    margin-right: var(--spacing-sm);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 80px;
    display: inline-block;
}


.commit-author {
    font-size: 11px;
    color: var(--description-fg);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 120px;
    display: inline-block;
}


.commit-meta {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-sm);
    font-size: 11px;
    color: var(--description-fg);
    margin-top: 2px;
}

/* ===== TREE VIEW ===== */
.tree-section {
    margin-bottom: var(--spacing-xs);
}

.tree-section-header {
    display: flex;
    align-items: center;
    padding: var(--spacing-xs) var(--spacing-sm);
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: background-color var(--transition-fast);
    user-select: none;
}

.tree-section-header:hover {
    background-color: var(--list-hover);
}

.tree-toggle {
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: var(--spacing-xs);
    font-size: 12px;
    color: var(--description-fg);
}

.tree-section-header.collapsed .tree-toggle {
    transform: rotate(-90deg);
}

.tree-section-title {
    font-weight: bold;
    font-size: 12px;
    color: var(--foreground);
}

.tree-section-subtitle {
    font-size: 11px;
    color: var(--description-fg);
    margin-left: var(--spacing-sm);
}

.tree-section-content {
    margin-left: var(--spacing-lg);
    border-left: 1px solid var(--panel-border);
    padding-left: var(--spacing-sm);
}

.tree-section-content.collapsed {
    display: none;
}

/* ===== FILE TREE ===== */
.file-changes-container {
    display: flex;
    flex-direction: column;
    height: 100%;
}

.file-changes-tree {
    flex: 1;
    overflow-y: auto;
    padding: var(--spacing-sm);
}

.file-tree-item {
    display: flex;
    align-items: center;
    padding: var(--spacing-xs) var(--spacing-sm);
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: background-color var(--transition-fast);
    user-select: none;
}

.file-tree-item:hover {
    background-color: var(--list-hover);
}

.file-tree-item.selected {
    background-color: var(--list-active);
    color: var(--list-active-fg);
}

.file-tree-icon {
    margin-right: var(--spacing-sm);
    font-size: 14px;
}

.file-tree-name {
    flex: 1;
    font-size: 12px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.file-tree-status {
    font-size: 10px;
    margin-left: var(--spacing-sm);
}

.file-tree-children {
    margin-left: 14px;
    border-left: 1px solid var(--panel-border);
    padding-left: 12px;
}
/* ===== COMPARE HEADER ===== */
.panel-compare-header {
    background-color: var(--panel-bg);
    padding: var(--spacing-sm) var(--spacing-md);
    border-bottom: 1px solid var(--panel-border);
    flex-shrink: 0;
    position: sticky;
    top: 50px; /* Below the main panel header */
    z-index: 10;
}

.compare-header-content {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.compare-icon {
    font-size: 14px;
    color: var(--description-fg);
    cursor: pointer;
}

.compare-info {
    font-size: 11px;
    color: var(--description-fg);
    font-style: italic;
}

/* ===== PANEL FOOTER ===== */
.panel-footer {
    background-color: var(--panel-bg);
    border-top: 1px solid var(--panel-border);
    padding: var(--spacing-sm) var(--spacing-md);
    flex-shrink: 0;
}

.panel-footer-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-sm);
}

.panel-footer-header h3 {
    font-size: 14px;
    color: var(--foreground);
}

.panel-footer-content {
    position: relative;
    overflow: hidden;
    width: 100%;
}

.commit-detail-item {
    display: flex;
    margin-bottom: var(--spacing-xs);
}

.commit-detail-label {
    font-weight: bold;
    margin-right: var(--spacing-sm);
    min-width: 60px;
    font-size: 11px;
    color: var(--description-fg);
}

.commit-detail-value {
    flex: 1;
    font-size: 11px;
    color: var(--foreground);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    min-width: 0;
}

/* ===== PAGINATION ===== */
.commit-pagination {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.commit-page-info {
    font-size: 11px;
    color: var(--description-fg);
}

.commit-pagination-btn {
    width: 24px;
    height: 24px;
    padding: 0;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* ===== COMMIT CAROUSEL ===== */
.commit-carousel {
    display: flex;
    flex-direction: row;
    transition: transform 0.3s ease-in-out;
    position: relative;
}

.commit-slide {
    width: 100%;
    flex-shrink: 0;
    padding: var(--spacing-sm);
    box-sizing: border-box;
    min-width: 0;
    flex: 0 0 100%;
}

.commit-slide .commit-detail-value {
    max-width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* ===== RESIZE HANDLES ===== */
.resize-handle {
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: 4px;
    background-color: transparent;
    cursor: col-resize;
    z-index: 10;
    transition: background-color var(--transition-fast);
}

.resize-handle:hover {
    background-color: var(--focus-border);
}

.resize-handle:active {
    background-color: var(--button-bg);
}

/* ===== DIFF VIEWER ===== */
#diffContent {
    padding: var(--spacing-md);
    font-family: 'Courier New', monospace;
    font-size: 12px;
    line-height: 1.4;
    overflow: auto;
    white-space: pre-wrap;
    word-wrap: break-word;
}

#diffContent pre {
    margin: 0;
    padding: 0;
    background: none;
    border: none;
    font-family: inherit;
    font-size: inherit;
    line-height: inherit;
}

#diffContent code {
    background: none;
    padding: 0;
    font-family: inherit;
    font-size: inherit;
    color: inherit;
}

.diff-header {
    background-color: var(--vscode-editor-background);
    color: var(--vscode-editor-foreground);
    padding: var(--spacing-xs) var(--spacing-sm);
    font-weight: bold;
    border-bottom: 1px solid var(--panel-border);
}

.diff-added {
    background-color: var(--diff-inserted-bg);
    color: var(--diff-inserted-fg);
}

.diff-removed {
    background-color: var(--diff-removed-bg);
    color: var(--diff-removed-fg);
}

.diff-context {
    background-color: transparent;
    color: var(--foreground);
}

/* ===== STATES ===== */
.empty-state {
    text-align: center;
    padding: var(--spacing-xl);
    color: var(--description-fg);
}

.empty-state h3 {
    margin-bottom: var(--spacing-sm);
    color: var(--foreground);
}

.loading {
    text-align: center;
    padding: var(--spacing-xl);
    color: var(--description-fg);
    font-style: italic;
}

/* ===== CONTEXT MENU ===== */
.context-menu {
    position: fixed;
    background-color: var(--menu-bg);
    color: var(--menu-fg);
    border: 1px solid var(--menu-border);
    border-radius: var(--radius-sm);
    box-shadow: var(--widget-shadow);
    z-index: 1000;
    min-width: 150px;
    padding: var(--spacing-xs) 0;
}

.context-menu-item {
    display: flex;
    align-items: center;
    padding: var(--spacing-xs) var(--spacing-md);
    cursor: pointer;
    transition: background-color var(--transition-fast);
}

.context-menu-item:hover {
    background-color: var(--menu-selection-bg);
    color: var(--menu-selection-fg);
}

.context-menu-icon {
    margin-right: var(--spacing-sm);
    font-size: 14px;
}

.context-menu-text {
    font-size: 12px;
}

.context-menu-separator {
    height: 1px;
    background-color: var(--menu-separator);
    margin: var(--spacing-xs) 0;
}

/* ===== UTILITY CLASSES ===== */
.hidden { display: none !important; }
.visible { display: block !important; }
.selected { background-color: var(--list-active) !important; }
.current { font-style: italic; text-decoration: underline; }
.modified { color: var(--charts-orange); }
.added { color: var(--charts-green); }
.deleted { color: var(--charts-red); }
.renamed { color: var(--charts-blue); }

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
    .main-content {
        flex-direction: column;
    }
    
    .panel {
        width: 100% !important;
        min-width: unset;
    }
    
    .resize-handle {
        display: none;
    }
}

/* ===== THEME FALLBACKS ===== */
@media (prefers-color-scheme: dark) {
    .user-filter,
    .compare-select {
        background-color: var(--input-bg, #1e1e1e);
        color: var(--input-fg, #cccccc);
        border-color: var(--input-border, #3c3c3c);
    }
    
    .user-filter option,
    .compare-select option {
        background-color: var(--dropdown-bg, #1e1e1e);
        color: var(--dropdown-fg, #cccccc);
    }
}

@media (prefers-color-scheme: light) {
    .user-filter,
    .compare-select {
        background-color: var(--input-bg, #ffffff);
        color: var(--input-fg, #000000);
        border-color: var(--input-border, #cccccc);
    }
    
    .user-filter option,
    .compare-select option {
        background-color: var(--dropdown-bg, #ffffff);
        color: var(--dropdown-fg, #000000);
    }
}